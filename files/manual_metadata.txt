Run:
JAVA_OPTS="-agentlib:native-image-agent=config-output-dir=./min-server-graal-agent2,experimental-class-define-support=true" sh ./min-server2/bin/standalone.sh

Then add the following:

relection:

    { "type": "org.jboss.logmanager.ExtHandler", "methods": [ { "name": "setEnabled", "parameterTypes": [ "boolean" ] } ] },
    {
    "type": "org.wildfly.security.WildFlyElytronDigestProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.WildFlyElytronHttpBasicProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.WildFlyElytronHttpBearerProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.WildFlyElytronHttpClientCertProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.WildFlyElytronHttpDigestProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.WildFlyElytronHttpFormProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.WildFlyElytronHttpSpnegoProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.WildFlyElytronProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.key.WildFlyElytronKeyProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.password.WildFlyElytronPasswordProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.credential.store.WildFlyElytronCredentialStoreProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.sasl.localuser.WildFlyElytronSaslLocalUserProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.sasl.anonymous.WildFlyElytronSaslAnonymousProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.sasl.gssapi.WildFlyElytronSaslGssapiProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.sasl.external.WildFlyElytronSaslExternalProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.http.external.WildFlyElytronHttpExternalProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.http.bearer.WildFlyElytronHttpBearerProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.sasl.digest.WildFlyElytronSaslDigestProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.sasl.entity.WildFlyElytronSaslEntityProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.sasl.gs2.WildFlyElytronSaslGs2Provider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.http.cert.WildFlyElytronHttpClientCertProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.sasl.scram.WildFlyElytronSaslScramProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.http.digest.WildFlyElytronHttpDigestProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.sasl.plain.WildFlyElytronSaslPlainProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.sasl.oauth2.WildFlyElytronSaslOAuth2Provider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.sasl.otp.WildFlyElytronSaslOTPProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.http.spnego.WildFlyElytronHttpSpnegoProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "org.wildfly.security.keystore.WildFlyElytronKeyStoreProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.digest.WildFlyElytronDigestProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.http.form.WildFlyElytronHttpFormProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.auth.client.WildFlyElytronClientDefaultSSLContextProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.security.http.basic.WildFlyElytronHttpBasicProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.wildfly.openssl.OpenSSLProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.bouncycastle.jce.provider.BouncyCastleProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
    "type": "org.bouncycastle.pqc.jcajce.provider.BouncyCastlePQCProvider",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
    {
      "type": "org.wildfly.security.ElytronMessages_$logger"
    },
    {
      "type": "org.wildfly.security.ElytronMessages_$logger",
      "methods": [
        {
          "name": "<init>",
          "parameterTypes": [
            "org.jboss.logging.Logger"
          ]
        }
      ]
    },
    {
      "type": "org.wildfly.security.auth.server.ElytronMessages_$logger"
    }
    ,
    {
      "type": "org.wildfly.security.auth.server.ElytronMessages_$logger",
      "methods": [
        {
          "name": "<init>",
          "parameterTypes": [
            "org.jboss.logging.Logger"
          ]
        }
      ]
    },
    {
      "type": "org.wildfly.security.mechanism._private.ElytronMessages_$logger"
    }
    ,
    {
      "type": "org.wildfly.security.mechanism._private.ElytronMessages_$logger",
      "methods": [
        {
          "name": "<init>",
          "parameterTypes": [
            "org.jboss.logging.Logger"
          ]
        }
      ]
    },
    {
      "type": "org.wildfly.security.http.digest.DigestMechanismFactory"
    },
    {
      "type": "org.wildfly.security.http.digest.DigestMechanismFactory",
      "methods": [
        {
          "name": "<init>",
          "parameterTypes": [
            "java.security.Provider"
          ]
        }
      ]
    },
    {
      "type": "org.wildfly.security.auth.realm.ElytronMessages_$logger"
    }
    ,
    {
      "type": "org.wildfly.security.auth.realm.ElytronMessages_$logger",
      "methods": [
        {
          "name": "<init>",
          "parameterTypes": [
            "org.jboss.logging.Logger"
          ]
        }
      ]
    },
    {
      "type": "org.wildfly.security.password.impl.PasswordFactorySpiImpl"
    },
{
    "type": "org.wildfly.security.password.impl.PasswordFactorySpiImpl",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  },
  {
    "type": "io.undertow.UndertowMessages_$bundle",
    "fields": [
      {
        "name": "INSTANCE"
      }
    ]
  },
    {
      "type": "io.undertow.UndertowMessages_$bundle"
    },
    {
      "type": "org.jboss.vfs.VFSLogger_$logger"
    }
    ,
    {
      "type": "org.jboss.vfs.VFSLogger_$logger",
      "methods": [
        {
          "name": "<init>",
          "parameterTypes": [
            "org.jboss.logging.Logger"
          ]
        }
      ]
    },
{
    "type": "io.undertow.servlet.handlers.DefaultServlet",
    "methods": [
      {
        "name": "<init>",
        "parameterTypes": []
      }
    ]
  }



resources:
,
        {
            "glob": "org/wildfly/security/ssl/TLS13MechanismDatabase.properties"
        },
        {
            "glob": "org/wildfly/security/ssl/MechanismDatabase.properties"
        },
        {
            "glob": "META-INF/services/java.security.Provider"
        }
